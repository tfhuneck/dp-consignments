import axios from 'axios';
import profile from '../images/New_Headshot.png'
import avatar from '../images/avatar.png'
import { useState, useEffect, useContext } from 'react';
import { AuthContext } from '../App';
import { NavLink, Link, useNavigate } from 'react-router-dom';
import authApp from '../config/firebase';
import { getAuth, signOut } from "firebase/auth";


function UserPanel() {
    
    const navigate  = useNavigate();
    const auth      = getAuth(authApp);
    const [ userAuth, setUserAuth ]         = useContext(AuthContext);
    const [ userData, setUserData ]         = useState();
    const serverUrl                         = 'http://localhost:8080' || `${process.env.REACT_APP_production_url}`;

    useEffect(() => {

        axios.get(serverUrl + '/getuser', {
            params: {userAuth}
        })
        .then((res) =>{
            console.log(res.data)
            const data = res.data;
            setUserData(data);
        })
    },[])

    const handleLogout = () => {
        signOut(auth).then(() => {
            // Sign-out successful.
            setUserAuth(null);
            navigate('/');
        }).catch((error) => {
        // An error happened.
        });
    }

    return (
        <>
            <div className='card usr container-fluid'>
                <div className='row d-flex '>
                    <div className='col d-flex justify-content-center'>
                        <img className='profile' src={ avatar} />
                    </div>
                </div>
                <div className='row d-flex '>
                    <div className='col d-flex justify-content-center'>
                        <br />
                        {userData && userData.name}
                    </div>
                </div>
                <div className='card-body d-flex flex-column justify-content-evenly'>
                    <div className='row justify-content-center'>
                        <Link className='user-nav-link' to='/usr/profile'>
                            <div className='col'>
                                <svg 
                                    className='user-nav-icn'
                                    stroke="currentColor"
                                    xmlns="http://www.w3.org/2000/svg" 
                                    version="1.1" 
                                    x="0px" 
                                    y="0px" 
                                    viewBox="0 0 54.691 68.36375000000001" 
                                >
                                    <path
                                        fill="currentColor" 
                                        d="M-4318.56-68.404c-43.25,0-78.438,35.186-78.438,78.435c0,43.252,35.188,78.439,78.438,78.439s78.436-35.188,78.436-78.439   C-4240.124-33.218-4275.31-68.404-4318.56-68.404z M-4318.867-35.187c13.682,0,24.771,11.092,24.771,24.771   c0,13.681-11.092,24.771-24.771,24.771c-13.683,0-24.771-11.092-24.771-24.771C-4343.639-24.095-4332.55-35.187-4318.867-35.187z    M-4274.686,65.074c-12.042,9.627-27.292,15.396-43.874,15.396c-16.562,0-31.797-5.75-43.834-15.354   c1.116-19.851,14.187-39.903,30.178-39.903h27.332c16.024,0,29.128,19.324,30.197,39.206c0.001,0.002,0.001,0.004,0.001,0.006   C-4274.686,64.427-4274.686,64.786-4274.686,65.074z"
                                    />
                                    <circle 
                                        fill="currentColor" 
                                        cx="27.443" 
                                        cy="21.101" 
                                        r="7.807"
                                    />
                                    <path 
                                        fill="currentColor"
                                        d="M27.345,2.659c-13.612,0-24.687,11.074-24.687,24.686c0,13.613,11.074,24.688,24.687,24.688   s24.687-11.074,24.687-24.688C52.032,13.733,40.958,2.659,27.345,2.659z M40.915,44.937c-0.269-6.156-4.318-12.13-9.278-12.13   h-8.387c-5,0-9.074,6.071-9.283,12.279c-5.373-4.062-8.853-10.502-8.853-17.742c0-12.258,9.974-22.23,22.231-22.23   c12.259,0,22.231,9.973,22.231,22.23C49.577,34.498,46.178,40.867,40.915,44.937z"
                                    />
                                </svg>
                            </div>
                            <div className='col nav-txt'>
                                Profile
                            </div>
                        </Link>
                    </div>
                    <div className='row justify-content-center'>
                        <Link className='user-nav-link' to='/usr/notifications'>
                            <div className='col'>
                                {/* <svg 
                                    className='user-nav-icn'
                                    // stroke="currentColor"
                                    xmlns="http://www.w3.org/2000/svg" 
                                    version="1.1" 
                                    x="0px" 
                                    y="0px" 
                                    viewBox="0 0 32 40"  
                                >
                                    <path
                                        fill="currentColor"  
                                        d="M29.635,21.223l-2.253-2.742v-5.999C27.382,6.206,22.276,1.1,16,1.1S4.618,6.206,4.618,12.481v5.999l-2.252,2.741   c-0.483,0.588-0.75,1.33-0.75,2.092c0,1.816,1.478,3.295,3.294,3.295h22.179c1.816,0,3.294-1.479,3.294-3.295   C30.384,22.552,30.118,21.81,29.635,21.223z M27.089,24.808H4.911c-0.824,0-1.495-0.67-1.495-1.494c0-0.345,0.121-0.682,0.34-0.948   l2.458-2.991c0.132-0.161,0.205-0.363,0.205-0.571v-6.321C6.418,7.198,10.716,2.9,16,2.9s9.582,4.298,9.582,9.581v6.321   c0,0.208,0.072,0.41,0.205,0.571l2.458,2.992c0.219,0.266,0.339,0.603,0.339,0.947C28.584,24.138,27.914,24.808,27.089,24.808z"
                                    />
                                    <path 
                                        fill="currentColor" 
                                        d="M19.167,29.1h-6.333c-0.497,0-0.9,0.403-0.9,0.9s0.403,0.9,0.9,0.9h6.333c0.497,0,0.9-0.403,0.9-0.9   S19.664,29.1,19.167,29.1z"
                                    />
                                </svg> */}
                                <svg 
                                    className='user-nav-icn'
                                    // stroke="currentColor"
                                    xmlns="http://www.w3.org/2000/svg" 
                                    version="1.1" 
                                    x="0px" 
                                    y="0px" 
                                    viewBox="0 0 32 40" 
                                >
                                    <path
                                        fill="#DF1E36" 
                                        d="M25.12,8.12c0.14-0.14,0.26-0.29,0.37-0.45c0.11-0.17,0.2-0.34,0.28-0.52c0.07-0.18,0.13-0.37,0.17-0.56     C25.98,6.39,26,6.2,26,6c0-0.2-0.02-0.39-0.06-0.59c-0.04-0.19-0.1-0.38-0.17-0.56c-0.08-0.18-0.17-0.35-0.28-0.52     c-0.11-0.16-0.23-0.31-0.37-0.45c-0.14-0.14-0.29-0.26-0.45-0.37c-0.17-0.11-0.34-0.2-0.52-0.28c-0.18-0.07-0.37-0.13-0.56-0.17     c-0.39-0.08-0.79-0.08-1.18,0c-0.19,0.04-0.38,0.1-0.56,0.17c-0.18,0.08-0.35,0.17-0.52,0.28c-0.16,0.11-0.31,0.23-0.45,0.37     C20.32,4.44,20,5.21,20,6s0.32,1.56,0.88,2.12C21.44,8.68,22.21,9,23,9S24.56,8.68,25.12,8.12z"
                                    />
                                    <path
                                        fill="currentColor" 
                                        d="M28,22v-0.76c0-1.07-0.42-2.07-1.17-2.83l-0.24-0.24C26.21,17.79,26,17.29,26,16.76V12c0-0.55-0.45-1-1-1s-1,0.45-1,1     v4.76c0,1.07,0.42,2.07,1.17,2.83l0.24,0.24c0.38,0.38,0.59,0.88,0.59,1.41V22c0,1.1-0.9,2-2,2H8c-1.1,0-2-0.9-2-2v-0.76     c0-0.53,0.21-1.04,0.59-1.41l0.24-0.24C7.58,18.83,8,17.83,8,16.76V12c0-4.41,3.59-8,8-8c0.3,0,0.6,0.02,0.89,0.05     c0.55,0.06,1.04-0.34,1.1-0.88c0.06-0.55-0.34-1.04-0.88-1.1C16.75,2.02,16.38,2,16,2C10.49,2,6,6.49,6,12v4.76     c0,0.53-0.21,1.04-0.59,1.41l-0.24,0.24C4.42,19.17,4,20.17,4,21.24V22c0,2.21,1.79,4,4,4h16C26.21,26,28,24.21,28,22z"
                                    />
                                    <path
                                        fill="currentColor" 
                                        d="M13,28c-0.55,0-1,0.45-1,1s0.45,1,1,1h6c0.55,0,1-0.45,1-1s-0.45-1-1-1H13z"
                                    />
                                </svg>
                            </div>
                            <div className='col nav-txt'>
                               Alerts
                            </div>
                        </Link>
                    </div>
                    <div className='row justify-content-center'>
                        <Link className='user-nav-link' to='/usr/settings'>
                            <div className='col'>
                                <svg 
                                    className='user-nav-icn'
                                    stroke="none"
                                    xmlns="http://www.w3.org/2000/svg" 
                                    viewBox="0 0 24 30" 
                                    x="0px" 
                                    y="0px"
                                >  
                                    <path 
                                        fill='currentColor'
                                        d="M21.39063,8.85889l-.47217-.12207c-.09131-.25049-.1919-.49561-.31836-.76563l.26025-.39014a2.00413,2.00413,0,0,0-.24853-2.52539L18.94434,3.38818a2.003,2.003,0,0,0-2.52491-.249l-.41894.24609c-.24072-.11181-.48731-.21337-.76709-.3125l-.09277-.46337A2.005,2.005,0,0,0,13.1792,1H10.8208A2.00587,2.00587,0,0,0,8.85889,2.60938l-.12207.47216c-.25049.09131-.49561.1919-.76563.31836l-.39014-.26025a2.00343,2.00343,0,0,0-2.5249.24805l-1.668,1.668a2.00421,2.00421,0,0,0-.249,2.52491l.24463.42041c-.11035.23925-.21045.48437-.30908.76318L2.605,8.85791A2.00694,2.00694,0,0,0,1,10.81885v2.3623a2.00678,2.00678,0,0,0,1.60645,1.96094l.47607.12305c.08984.24853.19043.4917.31641.76025l-.26319.396a2.00426,2.00426,0,0,0,.251,2.52148l1.67041,1.67041a2.00561,2.00561,0,0,0,2.521.25147l.4248-.248c.23877.11035.48291.21045.76123.30859l.09375.46973A2.00694,2.00694,0,0,0,10.81885,23h2.3623a2.00678,2.00678,0,0,0,1.96094-1.60645l.12305-.47607c.24853-.08984.49316-.19043.76123-.31543l.395.26221a2.00371,2.00371,0,0,0,2.52148-.251l1.67041-1.67041a2.0057,2.0057,0,0,0,.251-2.522l-.24707-.42432c.11035-.23926.21045-.48437.31006-.76318l.46338-.09277A2.005,2.005,0,0,0,23,13.1792V10.8208A2.00587,2.00587,0,0,0,21.39063,8.85889ZM21,13.1792l-.46338.09228a2.01176,2.01176,0,0,0-1.498,1.3086c-.07128.19678-.15087.39013-.23779.57861a2.01773,2.01773,0,0,0,.13526,1.9751l.26318.395-1.6709,1.66992-.394-.26172a2.008,2.008,0,0,0-1.9751-.13623q-.282.12965-.57666.23682a2.01375,2.01375,0,0,0-1.30762,1.49511L13.18115,21l-2.3623.001-.09424-.47022A2.012,2.012,0,0,0,9.4165,19.0376q-.293-.1062-.57519-.23682a2.0953,2.0953,0,0,0-.87793-.19531,1.97014,1.97014,0,0,0-1.09619.33057l-.396.26318L4.80078,17.5293l.26318-.396a2.01632,2.01632,0,0,0,.13575-1.97363q-.13038-.282-.23731-.57715A2.01375,2.01375,0,0,0,3.46729,13.2749L3,13.18115l-.001-2.3623.46973-.09424A2.01322,2.01322,0,0,0,4.9624,9.41748c.07129-.19678.15088-.39014.23682-.57715A2.01133,2.01133,0,0,0,5.063,6.86084l-.26074-.39111,1.668-1.66748.38965.26025a2.01329,2.01329,0,0,0,1.979.1377c.18945-.0879.38379-.167.581-.23877a2.01176,2.01176,0,0,0,1.3086-1.49805L10.8208,3h2.3584l.09228.46338a2.01261,2.01261,0,0,0,1.30957,1.49853q.29517.10694.57959.23829A2.01081,2.01081,0,0,0,17.13916,5.063l.39111-.26074,1.66748,1.668-.26025.38965a2.01225,2.01225,0,0,0-.1377,1.979c.0879.18945.167.38379.23877.581a2.01176,2.01176,0,0,0,1.498,1.3086L21,10.8208Z"
                                    />
                                    <path  
                                        fill='currentColor'
                                        d="M12,6a6,6,0,1,0,6,6A6.00657,6.00657,0,0,0,12,6Zm0,10a4,4,0,1,1,4-4A4.00458,4.00458,0,0,1,12,16Z"
                                    />
                                </svg>
                            </div>
                            <div className='col nav-txt'>
                                Settings
                            </div>
                        </Link>
                    </div>
                    <div className='row justify-content-center'>
                        <Link className='user-nav-link' onClick={handleLogout}>
                            <div className='col'>
                                <svg 
                                    className='user-nav-icn'
                                    xmlns="http://www.w3.org/2000/svg" 
                                    version="1.1" 
                                    x="0px" 
                                    y="0px" 
                                    viewBox="0 0 100 125" 
                                >
                                    <path 
                                        fill='currentColor'
                                        d="M25,86h29c2.8,0,5-2.2,5-5s-2.2-5-5-5H25c-2.2,0-4-1.8-4-4V28c0-2.2,1.8-4,4-4h29c2.8,0,5-2.2,5-5s-2.2-5-5-5H25   c-7.7,0-14,6.3-14,14v44C11,79.7,17.3,86,25,86z"
                                    />
                                    <path 
                                        fill='currentColor'
                                        d="M75,31c-2-2-5.1-2-7.1,0c-2,2-2,5.1,0,7.1l7,7H38c-2.8,0-5,2.2-5,5s2.2,5,5,5h35.9l-6,6c-2,2-2,5.1,0,7.1   c1,1,2.3,1.5,3.5,1.5S74.1,69,75,68l15-15c2-2,2-5.1,0-7.1L75,31z"
                                    />
                                </svg>
                            </div>
                            <div className='col nav-txt'>
                                Logout
                            </div>
                        </Link>
                    </div>
                </div>
            </div>
        </>
    )
}

export default UserPanel;